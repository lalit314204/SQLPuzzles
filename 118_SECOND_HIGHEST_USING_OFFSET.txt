CREATE TABLE REP
(
ID INT,
VAL INT
);

INSERT INTO REP VALUES (1,654);
INSERT INTO REP VALUES (1,65498);
INSERT INTO REP VALUES (1,56198);
INSERT INTO REP VALUES (1,54998);
INSERT INTO REP VALUES (2,84285);
INSERT INTO REP VALUES (2,58451);
INSERT INTO REP VALUES (2,85451);
INSERT INTO REP VALUES (3,65168);
INSERT INTO REP VALUES (3,32997);
INSERT INTO REP VALUES (3,54841);


SELECT ID,(SELECT B.VAL FROM REP B WHERE A.ID=B.ID ORDER BY B.VAL DESC OFFSET 1 ROWS FETCH NEXT 1 ROWS ONLY) SECHIGH FROM REP A GROUP BY A.ID;

SELECT ID,VAL,ROW_NUMBER() OVER (PARTITION BY ID ORDER BY VAL DESC) RNK FROM REP;