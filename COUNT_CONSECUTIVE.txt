CREATE TABLE SEQ_CNT
(
ID INT,
VAL CHAR(20)
);

INSERT INTO SEQ_CNT VALUES (1,'P');
INSERT INTO SEQ_CNT VALUES (2,'Q');
INSERT INTO SEQ_CNT VALUES (2,'Q');
INSERT INTO SEQ_CNT VALUES (2,'Q');
INSERT INTO SEQ_CNT VALUES (1,'P');
INSERT INTO SEQ_CNT VALUES (1,'P');
INSERT INTO SEQ_CNT VALUES (2,'Q');


SELECT ID,VAL,COUNT(B) CNT FROM(
SELECT ID,VAL,RNK,ROW_NUMBER() OVER (PARTITION BY VAL ORDER BY RNK)-RNK B FROM (SELECT ID,VAL,ROW_NUMBER() OVER(ORDER BY 1) RNK FROM SEQ_CNT))
GROUP BY ID,VAL,B
ORDER BY MIN(RNK);

SELECT ID,VAL,ROW_NUMBER() OVER(ORDER BY 1) RNK FROM SEQ_CNT;

SELECT ID,VAL,RNK,ROW_NUMBER() OVER (PARTITION BY VAL ORDER BY RNK) FROM (SELECT ID,VAL,ROW_NUMBER() OVER(ORDER BY 1) RNK FROM SEQ_CNT);

SELECT ID,VAL,RNK,ROW_NUMBER() OVER (PARTITION BY VAL ORDER BY RNK)-RNK B FROM (SELECT ID,VAL,ROW_NUMBER() OVER(ORDER BY 1) RNK FROM SEQ_CNT);