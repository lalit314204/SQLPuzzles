CREATE TABLE REMALL
(
ID INT,
VAL CHAR(1),
DAT CHAR(6)
);

INSERT INTO REMALL VALUES (1,'A','SIMPLE');
INSERT INTO REMALL VALUES (1,'A','ALL');
INSERT INTO REMALL VALUES (1,'A','DOUBLE');
INSERT INTO REMALL VALUES (2,'B','TRIPLE');
INSERT INTO REMALL VALUES (2,'B','ALL');
INSERT INTO REMALL VALUES (3,'C','ALL');
INSERT INTO REMALL VALUES (3,'C','SIMPLE');
INSERT INTO REMALL VALUES (3,'C','DOUBLE');
INSERT INTO REMALL VALUES (4,'E','ALL');
INSERT INTO REMALL VALUES (5,'F','ALL');

SELECT ID,VAL,DAT FROM REMALL WHERE DAT!='ALL'
UNION ALL
SELECT ID,VAL,MAX(DAT)FROM REMALL GROUP BY ID,VAL HAVING COUNT(*)=1 AND MAX(DAT)='ALL';